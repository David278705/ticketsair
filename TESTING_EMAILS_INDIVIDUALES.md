# üß™ Gu√≠a de Testing - Sistema de Emails Individuales

## ‚úÖ Pre-requisitos

1. ‚úÖ Servidor Laravel corriendo: `php artisan serve --port=8000`
2. ‚úÖ Vite corriendo: `npm run dev`
3. ‚úÖ Mailtrap configurado en `.env`
4. ‚úÖ Cache limpiada: `php artisan view:clear && php artisan config:clear`

---

## üìã Test 1: Email Obligatorio

### **Objetivo**: Verificar que no se puede crear booking sin email

### **Pasos**:

1. Ir a `/` (p√°gina principal)
2. Buscar un vuelo disponible
3. Click en "Comprar" o "Reservar"
4. Ingresar datos de pasajero **SIN email**
5. Click en "Continuar"

### **Resultado Esperado**:

```
‚ùå Error de validaci√≥n
"El campo email es obligatorio"
```

### **Status**: [ ] Pendiente [ ] ‚úÖ Aprobado [ ] ‚ùå Fallo

---

## üìã Test 2: Compra Individual (1 Pasajero)

### **Objetivo**: Verificar email personalizado para 1 pasajero

### **Pasos**:

1. Buscar vuelo disponible
2. Click en "Comprar"
3. Ingresar datos de 1 pasajero:
    ```
    Nombre: Juan
    Apellido: P√©rez
    DNI: 1234567890
    Email: juan@test.com
    Fecha nacimiento: 01/01/1990
    G√©nero: M
    ```
4. Click "Continuar"
5. Ingresar datos de tarjeta (simulado)
6. Confirmar compra

### **Resultado Esperado**:

#### **Email en Mailtrap**:

```
Para: juan@test.com
Asunto: ‚úÖ Confirmaci√≥n de Compra - Vuelo [C√ìDIGO]

Hola Juan,

Tu Informaci√≥n Personal
- Pasajero: JUAN P√âREZ
- DNI: 1234567890
- Asiento: [ASIENTO]
- Clase: Econ√≥mica

[NO debe aparecer secci√≥n "Otros Pasajeros"]

Pr√≥ximos Pasos
1. Check-in: 24 horas antes...
```

#### **Log en Laravel**:

```
[INFO] Email de compra enviado a: juan@test.com (Juan P√©rez)
```

### **Status**: [ ] Pendiente [ ] ‚úÖ Aprobado [ ] ‚ùå Fallo

---

## üìã Test 3: Compra Grupal (3 Pasajeros)

### **Objetivo**: Verificar emails individuales personalizados

### **Pasos**:

1. Buscar vuelo disponible
2. Click en "Comprar"
3. Agregar 3 pasajeros:

    ```
    Pasajero 1:
    - Nombre: Juan P√©rez
    - Email: juan@test.com
    - DNI: 1111111111

    Pasajero 2:
    - Nombre: Mar√≠a Garc√≠a
    - Email: maria@test.com
    - DNI: 2222222222

    Pasajero 3:
    - Nombre: Pedro L√≥pez
    - Email: pedro@test.com
    - DNI: 3333333333
    ```

4. Confirmar compra

### **Resultado Esperado**:

#### **Email 1 (juan@test.com)**:

```
Hola Juan,

Tu Informaci√≥n Personal
- Pasajero: JUAN P√âREZ
- DNI: 1111111111
- Asiento: 12A

Otros Pasajeros en esta Reserva
‚Ä¢ Mar√≠a Garc√≠a (2222222222) - Asiento: 12B
‚Ä¢ Pedro L√≥pez (3333333333) - Asiento: 12C
```

#### **Email 2 (maria@test.com)**:

```
Hola Mar√≠a,

Tu Informaci√≥n Personal
- Pasajero: MAR√çA GARC√çA
- DNI: 2222222222
- Asiento: 12B

Otros Pasajeros en esta Reserva
‚Ä¢ Juan P√©rez (1111111111) - Asiento: 12A
‚Ä¢ Pedro L√≥pez (3333333333) - Asiento: 12C
```

#### **Email 3 (pedro@test.com)**:

```
Hola Pedro,

Tu Informaci√≥n Personal
- Pasajero: PEDRO L√ìPEZ
- DNI: 3333333333
- Asiento: 12C

Otros Pasajeros en esta Reserva
‚Ä¢ Juan P√©rez (1111111111) - Asiento: 12A
‚Ä¢ Mar√≠a Garc√≠a (2222222222) - Asiento: 12B
```

#### **Log en Laravel**:

```
[INFO] Email de compra enviado a: juan@test.com (Juan P√©rez)
[INFO] Email de compra enviado a: maria@test.com (Mar√≠a Garc√≠a)
[INFO] Email de compra enviado a: pedro@test.com (Pedro L√≥pez)
```

### **Status**: [ ] Pendiente [ ] ‚úÖ Aprobado [ ] ‚ùå Fallo

---

## üìã Test 4: Reserva Individual

### **Objetivo**: Verificar email de reserva personalizado

### **Pasos**:

1. Buscar vuelo disponible
2. Click en "Reservar"
3. Ingresar datos de 1 pasajero con email
4. Confirmar reserva

### **Resultado Esperado**:

#### **Email en Mailtrap**:

```
Para: pasajero@test.com
Asunto: Confirmaci√≥n de Reserva - TicketsAir

Hola [Nombre],

Tu Informaci√≥n Personal
- Pasajero: [NOMBRE COMPLETO]
- DNI: [DNI]
- Asiento: [ASIENTO]

C√≥digo de Reserva: RES-XXXXXX

‚ö†Ô∏è IMPORTANTE: Esta reserva expira el [FECHA] (24 horas)
```

### **Status**: [ ] Pendiente [ ] ‚úÖ Aprobado [ ] ‚ùå Fallo

---

## üìã Test 5: Check-in Individual (1 Pasajero)

### **Objetivo**: Verificar PDF sin secci√≥n "Otros Pasajeros"

### **Pasos**:

1. Completar Test 2 (compra de 1 pasajero)
2. Esperar o modificar vuelo para que est√© dentro de 24h
3. Ir a "Mis Viajes"
4. Click en "Check-in" del vuelo
5. Ingresar c√≥digo de ticket o DNI

### **Resultado Esperado**:

#### **Email en Mailtrap**:

```
Para: juan@test.com
Asunto: ‚úàÔ∏è Tu Pasabordo - Vuelo [C√ìDIGO]

Adjunto: Pasabordo_TKT-XXXXXX.pdf
```

#### **PDF Generado** (`storage/app/public/boarding-passes/`):

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ PASAJERO PRINCIPAL                  ‚îÇ
‚îÇ JUAN P√âREZ                          ‚îÇ
‚îÇ DNI: 1234567890                     ‚îÇ
‚îÇ Asiento: 12A                        ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

[NO debe aparecer secci√≥n "Otros Pasajeros"]

‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ ||||||||||||||||||||||||||||||     ‚îÇ
‚îÇ TKT-XXXXXX                          ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

#### **Log en Laravel**:

```
[INFO] Pasabordo enviado a: juan@test.com para ticket TKT-XXXXXX
```

### **Status**: [ ] Pendiente [ ] ‚úÖ Aprobado [ ] ‚ùå Fallo

---

## üìã Test 6: Check-in Grupal (3 Pasajeros)

### **Objetivo**: Verificar PDFs individuales con lista de compa√±eros

### **Pasos**:

1. Completar Test 3 (compra de 3 pasajeros)
2. Hacer check-in del **Pasajero 1** (Juan)
3. Hacer check-in del **Pasajero 2** (Mar√≠a)
4. Hacer check-in del **Pasajero 3** (Pedro)

### **Resultado Esperado**:

#### **Check-in 1 (Juan)**:

**Email**: Solo a `juan@test.com`  
**PDF**:

```
PASAJERO PRINCIPAL
JUAN P√âREZ (1111111111) - Asiento: 12A

üìã OTROS PASAJEROS EN ESTA RESERVA
‚Ä¢ MAR√çA GARC√çA (2222222222) - Asiento: 12B
‚Ä¢ PEDRO L√ìPEZ (3333333333) - Asiento: 12C
```

#### **Check-in 2 (Mar√≠a)**:

**Email**: Solo a `maria@test.com`  
**PDF**:

```
PASAJERO PRINCIPAL
MAR√çA GARC√çA (2222222222) - Asiento: 12B

üìã OTROS PASAJEROS EN ESTA RESERVA
‚Ä¢ JUAN P√âREZ (1111111111) - Asiento: 12A
‚Ä¢ PEDRO L√ìPEZ (3333333333) - Asiento: 12C
```

#### **Check-in 3 (Pedro)**:

**Email**: Solo a `pedro@test.com`  
**PDF**:

```
PASAJERO PRINCIPAL
PEDRO L√ìPEZ (3333333333) - Asiento: 12C

üìã OTROS PASAJEROS EN ESTA RESERVA
‚Ä¢ JUAN P√âREZ (1111111111) - Asiento: 12A
‚Ä¢ MAR√çA GARC√çA (2222222222) - Asiento: 12B
```

#### **Logs en Laravel**:

```
[INFO] Pasabordo enviado a: juan@test.com para ticket TKT-ABC123
[INFO] Pasabordo enviado a: maria@test.com para ticket TKT-ABC124
[INFO] Pasabordo enviado a: pedro@test.com para ticket TKT-ABC125
```

### **Status**: [ ] Pendiente [ ] ‚úÖ Aprobado [ ] ‚ùå Fallo

---

## üìã Test 7: Due√±o de Cuenta NO Recibe Duplicados

### **Objetivo**: Verificar que el due√±o NO recibe copias

### **Pasos**:

1. Login como usuario: `user@test.com`
2. Comprar vuelo con 2 pasajeros:
    - Pasajero 1: `pasajero1@test.com`
    - Pasajero 2: `pasajero2@test.com`
3. Revisar Mailtrap

### **Resultado Esperado**:

#### **Emails Recibidos**:

-   ‚úÖ `pasajero1@test.com` - Email de compra
-   ‚úÖ `pasajero2@test.com` - Email de compra
-   ‚ùå `user@test.com` - NO debe recibir nada

### **Status**: [ ] Pendiente [ ] ‚úÖ Aprobado [ ] ‚ùå Fallo

---

## üìã Test 8: Conversi√≥n Reserva ‚Üí Compra

### **Objetivo**: Verificar emails en conversi√≥n

### **Pasos**:

1. Crear reserva con 2 pasajeros
2. Ir a "Mis Viajes"
3. Click en "Completar Compra"
4. Ingresar datos de pago
5. Confirmar

### **Resultado Esperado**:

#### **Emails Individuales**:

-   ‚úÖ Cada pasajero recibe email de compra personalizado
-   ‚úÖ Logs muestran env√≠os individuales

### **Status**: [ ] Pendiente [ ] ‚úÖ Aprobado [ ] ‚ùå Fallo

---

## üêõ Troubleshooting

### **Problema 1: No llegan emails**

```bash
# Verificar configuraci√≥n Mailtrap
php artisan tinker
Mail::raw('Test', function($m) { $m->to('test@test.com')->subject('Test'); });

# Ver logs
tail -f storage/logs/laravel.log
```

### **Problema 2: PDF no se genera**

```bash
# Verificar permisos
chmod -R 775 storage/app/public/boarding-passes

# Verificar enlace simb√≥lico
php artisan storage:link

# Listar PDFs generados
ls -la storage/app/public/boarding-passes/
```

### **Problema 3: Error en vista Blade**

```bash
# Limpiar cach√©
php artisan view:clear
php artisan config:clear
php artisan cache:clear
```

---

## ‚úÖ Checklist Final

### **Funcionalidad**

-   [ ] Email obligatorio validado correctamente
-   [ ] Emails individuales personalizados (compra)
-   [ ] Emails individuales personalizados (reserva)
-   [ ] PDF muestra pasajero principal
-   [ ] PDF muestra otros pasajeros (si aplica)
-   [ ] PDFs individuales por pasajero en check-in
-   [ ] Due√±o NO recibe copias

### **UI/UX**

-   [ ] Mensajes de error claros
-   [ ] Confirmaci√≥n de compra/reserva visible
-   [ ] Redirecci√≥n a "Mis Viajes" funciona
-   [ ] Check-in accesible desde "Mis Viajes"

### **Logs**

-   [ ] Logs muestran emails enviados con nombre
-   [ ] Logs muestran errores de env√≠o
-   [ ] Logs muestran generaci√≥n de PDF

### **Mailtrap**

-   [ ] Emails llegan correctamente
-   [ ] Formato profesional
-   [ ] PDFs adjuntos correctos
-   [ ] Sin duplicados

---

## üìä Reporte de Testing

**Fecha**: ******\_\_\_******  
**Tester**: ******\_\_\_******

| Test                   | Status        | Notas |
| ---------------------- | ------------- | ----- |
| 1. Email Obligatorio   | [ ] ‚úÖ [ ] ‚ùå |       |
| 2. Compra Individual   | [ ] ‚úÖ [ ] ‚ùå |       |
| 3. Compra Grupal       | [ ] ‚úÖ [ ] ‚ùå |       |
| 4. Reserva Individual  | [ ] ‚úÖ [ ] ‚ùå |       |
| 5. Check-in Individual | [ ] ‚úÖ [ ] ‚ùå |       |
| 6. Check-in Grupal     | [ ] ‚úÖ [ ] ‚ùå |       |
| 7. Sin Duplicados      | [ ] ‚úÖ [ ] ‚ùå |       |
| 8. Conversi√≥n Reserva  | [ ] ‚úÖ [ ] ‚ùå |       |

**Resultado Global**: [ ] ‚úÖ Aprobado [ ] ‚ùå Requiere correcciones

---

**Versi√≥n**: 2.0.0  
**Fecha**: 24 de octubre de 2025
